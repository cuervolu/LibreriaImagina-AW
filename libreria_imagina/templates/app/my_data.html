{% extends 'base.html' %}

{% load static %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/my_data.css' %}" />
{% endblock %}
{% load humanize %}
{% block title %}Mi datos{% endblock title %}

{% block content %}
<hr>
<div class="container my-5 py-3">
    <div class="row justify-content-start mb-2">
        <div class="col-auto col-md-auto col-lg-auto">
            <p class="" style="font-size: 30px; font-weight: 600;">Mis Datos</p>
        </div>
    </div>
    <p class="mb-4" style="font-size: 19px; font-weight: 600;">Datos de cuenta</p>
    <!-- Card -->
    <div class="card mb-5 d-flex"
        style="border-radius: 15px; filter: drop-shadow(0px 20px 88px rgba(0, 0, 0, 0.1)); border: none;">
        <div class="row mx-3 my-4">
            <div class="col-sm-12 col-md-12 col-lg-12 mb-2">
                <div>
                    <button class="btn border-0 w-100" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseUsername" aria-expanded="false" aria-controls="collapseUsername">
                        <div class="row justify-content-between align-items-center">
                            <div class="col-7 col-sm-10">
                                <div class="row">
                                    <div class="col-12 col-sm-12 col-md-4 col-lg-4 text-start text-nowrap">
                                        <h6>Usuario</h6>
                                    </div>
                                    <div class="col-12 col-sm-12 col-md-8 col-lg-8  text-start">
                                        <h6 class="datos-info">{{ usuario.username }}</h6>
                                    </div>
                                </div>
                            </div>
                            <div class="col-1 text-end">
                                <i class="fa-solid fa-chevron-right rotate-icon"></i>
                            </div>
                        </div>
                    </button>
                    <div class="collapse" id="collapseUsername">
                        <div class="card card-body border-0">
                            <hr class="mt-0">
                            <h6>Cambiar nombre de usuario:</h6>
                            <div>
                                <div class="row align-items-center justify-content-between">
                                    <div class="col-sm-12 col-md-4 col-lg-4">
                                        <h6 class="datos-info">Nuevo Username</h6>
                                    </div>
                                    <div class="col-sm-12 col-md-8 col-lg-8 d-flex">
                                        <input type="text" name="username" autofocus autocapitalize="none"
                                            autocomplete="username" maxlength="30" class="text-input form-control"
                                            required style="box-shadow: none;">
                                        <button class="btn ms-3"
                                            style="color: white; background-color: #82C2CB; border-radius: 0;">Cambiar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="col-sm-12 col-md-12 col-lg-12">
                <div>
                    <button class="btn border-0 w-100" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseEmail" aria-expanded="false" aria-controls="collapseEmail">
                        <div class="row justify-content-between align-items-center">
                            <div class="col-7 col-sm-10">
                                <div class="row">
                                    <div class="col-12 col-sm-12 col-md-4 col-lg-4 text-start text-nowrap">
                                        <h6>Email</h6>
                                    </div>
                                    <div class="col-12 col-sm-12 col-md-8 col-lg-8  text-start">
                                        <h6 class="datos-info">{{ usuario.correo }}</h6>
                                    </div>
                                </div>
                            </div>
                            <div class="col-1 text-end">
                                <i class="fa-solid fa-chevron-right rotate-icon"></i>
                            </div>
                        </div>
                    </button>
                    <div class="collapse" id="collapseEmail">
                        <div class="card card-body border-0">
                            <hr class="mt-0">
                            <h6>Cambiar correo electrónico:</h6>
                            <div>
                                <div class="row align-items-center justify-content-between">
                                    <div class="col-sm-12 col-md-4 col-lg-4">
                                        <h6 class="datos-info">Nuevo Correo</h6>
                                    </div>
                                    <div class="col-sm-12 col-md-8 col-lg-8 d-flex">
                                        <input type="text" name="email" autofocus autocapitalize="none"
                                            autocomplete="email" maxlength="150" class="text-input form-control"
                                            required style="box-shadow: none;">
                                        <button class="btn ms-3"
                                            style="color: white; background-color: #82C2CB; border-radius: 0;">Cambiar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="col-sm-12 col-md-12 col-lg-12">
                <div>
                    <button class="btn border-0 w-100" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseContraseña" aria-expanded="false" aria-controls="collapseContraseña">
                        <div class="row justify-content-between align-items-center">
                            <div class="col-7 col-sm-10">
                                <div class="row">
                                    <div class="col-12 col-sm-12 col-md-4 col-lg-4 text-start text-nowrap">
                                        <h6>Contraseña</h6>
                                    </div>
                                    <div class="col-12 col-sm-12 col-md-8 col-lg-8  text-start">
                                        <h6 class="datos-info">************</h6>
                                    </div>
                                </div>
                            </div>
                            <div class="col-1 text-end">
                                <i class="fa-solid fa-chevron-right rotate-icon"></i>
                            </div>
                        </div>
                    </button>
                    <div class="collapse" id="collapseContraseña">
                        <div class="card card-body border-0">
                            <hr class="mt-0">
                            <h6>Cambiar contraseña:</h6>
                            <div>
                                <div>
                                    <div class="row align-items-center justify-content-between mb-2">
                                        <div class="col-sm-12 col-md-4 col-lg-4">
                                            <h6 class="datos-info">Contraseña Actual</h6>
                                        </div>
                                        <div class="col-sm-12 col-md-8 col-lg-8 d-flex">
                                            <input type="password" name="password" autofocus autocapitalize="none"
                                                maxlength="150" class="text-input form-control" required
                                                style="box-shadow: none;">
                                        </div>
                                    </div>
                                    <div class="row align-items-center justify-content-between mb-2">
                                        <div class="col-sm-12 col-md-4 col-lg-4">
                                            <h6 class="datos-info">Nueva Contraseña</h6>
                                        </div>
                                        <div class="col-sm-12 col-md-8 col-lg-8 d-flex">
                                            <input type="password" name="password" autofocus autocapitalize="none"
                                                maxlength="150" class="text-input form-control" required
                                                style="box-shadow: none;">
                                        </div>
                                    </div>
                                    <div class="row align-items-center justify-content-between">
                                        <div class="col-sm-12 col-md-4 col-lg-4">
                                            <h6 class="datos-info">Confirmar Contraseña</h6>
                                        </div>
                                        <div class="col-sm-12 col-md-8 col-lg-8 d-flex">
                                            <input type="password" name="password" autofocus autocapitalize="none"
                                                maxlength="150" class="text-input form-control" required
                                                style="box-shadow: none;">
                                            <button class="btn ms-3"
                                                style="color: white; background-color: #82C2CB; border-radius: 0;">Cambiar</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- End Card -->
    <p class="mb-4" style="font-size: 19px; font-weight: 600;">Datos Personales</p>
    <!-- Card -->
    <div class="card mb-5 d-flex"
        style="border-radius: 15px; filter: drop-shadow(0px 20px 88px rgba(0, 0, 0, 0.1)); border: none;">
        <div class="row mx-3 my-4">
            <div class="col-sm-12 col-md-12 col-lg-12 mb-2">
                <div>
                    <button class="btn border-0 w-100" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseNombreApellido" aria-expanded="false"
                        aria-controls="collapseNombreApellido">
                        <div class="row justify-content-between align-items-center">
                            <div class="col-7 col-sm-10">
                                <div class="row">
                                    <div class="col-12 col-sm-12 col-md-4 col-lg-4 text-start text-nowrap">
                                        <h6>Nombre y Apellido</h6>
                                    </div>
                                    <div class="col-12 col-sm-12 col-md-8 col-lg-8  text-start">
                                        <h6 class="datos-info">{{ usuario.nombre }} {{ usuario.apellido }}</h6>
                                    </div>
                                </div>
                            </div>
                            <div class="col-1 text-end">
                                <i class="fa-solid fa-chevron-right rotate-icon"></i>
                            </div>
                        </div>
                    </button>
                    <div class="collapse" id="collapseNombreApellido">
                        <div class="card card-body border-0">
                            Some placeholder content for the collapse component. This panel is hidden by default but
                            revealed when the user activates the relevant trigger.
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="col-sm-12 col-md-12 col-lg-12">
                <div>
                    <button class="btn border-0 w-100" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseRut" aria-expanded="false" aria-controls="collapseRut">
                        <div class="row justify-content-between align-items-center">
                            <div class="col-7 col-sm-10">
                                <div class="row">
                                    <div class="col-12 col-sm-12 col-md-4 col-lg-4 text-start text-nowrap">
                                        <h6>Rut</h6>
                                    </div>
                                    <div class="col-12 col-sm-12 col-md-8 col-lg-8  text-start">
                                        <h6 class="datos-info">{{ usuario.rut }}</h6>
                                    </div>
                                </div>
                            </div>
                            <div class="col-1 text-end">
                                <i class="fa-solid fa-chevron-right rotate-icon"></i>
                            </div>
                        </div>
                    </button>
                    <div class="collapse" id="collapseRut">
                        <div class="card card-body border-0">
                            Some placeholder content for the collapse component. This panel is hidden by default but
                            revealed when the user activates the relevant trigger.
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="col-sm-12 col-md-12 col-lg-12">
                <div>
                    <button class="btn border-0 w-100" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseTelefono" aria-expanded="false" aria-controls="collapseTelefono">
                        <div class="row justify-content-between align-items-center">
                            <div class="col-7 col-sm-10">
                                <div class="row">
                                    <div class="col-12 col-sm-12 col-md-4 col-lg-4 text-start text-nowrap">
                                        <h6>Teléfono</h6>
                                    </div>
                                    <div class="col-12 col-sm-12 col-md-8 col-lg-8  text-start">
                                        <h6 class="datos-info">{{ usuario.telefono }}</h6>
                                    </div>
                                </div>
                            </div>
                            <div class="col-1 text-end">
                                <i class="fa-solid fa-chevron-right rotate-icon"></i>
                            </div>
                        </div>
                    </button>
                    <div class="collapse" id="collapseTelefono">
                        <div class="card card-body border-0">
                            <hr class="mt-0">
                            <h6>Cambiar Teléfono:</h6>
                            <div>
                                <div class="row align-items-center justify-content-between">
                                    <div class="col-sm-12 col-md-4 col-lg-4">
                                        <h6 class="datos-info">Nuevo telefono</h6>
                                    </div>
                                    <div class="col-sm-12 col-md-8 col-lg-8 d-flex">
                                        <input type="tel" name="telefono" autofocus autocapitalize="none"
                                            autocomplete="tel" maxlength="8" class="text-input form-control" required
                                            style="box-shadow: none;">
                                        <button class="btn ms-3"
                                            style="color: white; background-color: #82C2CB; border-radius: 0;">Cambiar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Card -->
    <p class="mb-4" style="font-size: 19px; font-weight: 600;">Tarjetas</p>
    <!-- Card -->
    <div class="card mb-5 d-flex"
        style="border-radius: 15px; filter: drop-shadow(0px 20px 88px rgba(0, 0, 0, 0.1)); border: none;">
        <div class="row mx-3 mt-4">
            {% if tarjetas %}
            {% for metodo_pago in tarjetas %}
            <div class="col-sm-12 col-md-12 col-lg-12 mb-2 d-flex align-items-center">
                <div class="d-flex justify-content-center align-items-center metodo-pago">
                    {% if metodo_pago.tarjeta_numero|slice:"0:1" == '4' %}
                    <img src="{% static 'img/Visa.png' %}" alt="" class="img-fluid">
                    {% elif metodo_pago.tarjeta_numero|slice:"0:2" == '51' or metodo_pago.tarjeta_numero|slice:"0:2" == '52' or metodo_pago.tarjeta_numero|slice:"0:2" == '53' or metodo_pago.tarjeta_numero|slice:"0:2" == '54' or metodo_pago.tarjeta_numero|slice:"0:2" == '55' %}
                    <img src="{% static 'img/Mastercard.png' %}" alt="" class="img-fluid">
                    {% elif metodo_pago.tarjeta_numero|slice:"0:2" == '34' or metodo_pago.tarjeta_numero|slice:"0:2" == '37' %}
                    <img src="{% static 'img/AmericanExpress.png' %}" alt="" class="img-fluid">
                    {% else %}
                    <img src="{% static 'img/OtraTarjeta.png' %}" alt="" class="img-fluid">
                    {% endif %}
                </div>
                <div class="ms-4">
                    <h6>Terminada en {{ metodo_pago.tarjeta_numero|slice:"-4:" }}</h6>
                    {% if metodo_pago.tarjeta_numero|slice:"0:1" == '4' %}
                    <h6 style="font-size: 14px; font-weight: 300;">Visa</h6>
                    {% elif metodo_pago.tarjeta_numero|slice:"0:2" == '51' or metodo_pago.tarjeta_numero|slice:"0:2" == '52' or metodo_pago.tarjeta_numero|slice:"0:2" == '53' or metodo_pago.tarjeta_numero|slice:"0:2" == '54' or metodo_pago.tarjeta_numero|slice:"0:2" == '55' %}
                    <h6 style="font-size: 14px; font-weight: 300;">Mastercard</h6>
                    {% elif metodo_pago.tarjeta_numero|slice:"0:2" == '34' or metodo_pago.tarjeta_numero|slice:"0:2" == '37' %}
                    <h6 style="font-size: 14px; font-weight: 300;">American Express</h6>
                    {% else %}
                    <h6 style="font-size: 14px; font-weight: 300;">Otro tipo de tarjeta</h6>
                    {% endif %}
                    <h6 style="font-size: 14px; font-weight: 300;">Vencimiento: {{ metodo_pago.fecha_vencimiento|date:"m/Y" }}</h6>
                </div>
                <form method="POST" action="{% url 'eliminar_metodo_pago' metodo_pago.id %}" class="ms-auto text-end">
                    {% csrf_token %}
                    <div>
                        <button class="btn border-0" type="submit" style="color: #207198;">Eliminar</button>
                    </div>
                </form>
            </div>
            <hr class="mt-3">
            {% endfor %}
            {% else %}
            <div class="col-sm-12 col-md-12 col-lg-12 mb-2 d-flex align-items-center">
                <div class="mx-auto my-3">
                    <h4>Aún no posees tarjetas en tu cuenta</h4>
                </div>
            </div>
            <hr>
            {% endif %}
            <div class="col-sm-12 col-md-12 col-lg-12 text-center ms-auto">
                <button class="btn border-0" type="button" style="color: #207198;" data-bs-toggle="modal"
                    data-bs-target="#agregarTarjetaModal">
                    <div class="d-flex my-2">
                        <h5>+ Nueva Tarjeta</h5>
                    </div>
                </button>
            </div>
        </div>
    </div>
    <!-- End Card -->
    <p class="mb-4" style="font-size: 19px; font-weight: 600;">Domicilios</p>
    <!-- Card -->
    <div class="card mb-5 d-flex"
        style="border-radius: 15px; filter: drop-shadow(0px 20px 88px rgba(0, 0, 0, 0.1)); border: none;">
        <div class="row mx-3 mt-4 mb-2">
            {% if direcciones != None %}
            <div class="col-sm-12 col-md-12 col-lg-12 my-auto d-flex align-items-center">
                <div class="d-flex justify-content-center align-items-center ms-2">
                    <img src="{% static 'img/direction-point.svg' %}" alt="" class="img-fluid" width="18px">
                </div>
                <div class="ms-4">
                    <h6>{{ usuario.direccion }}</h6>
                    <h6 style="font-size: 14px; font-weight: 300;">{{ usuario.direccion.comuna.region.nombre }} -
                        {{ usuario.direccion.comuna.nombre_comuna}}</h6>
                    <h6 style="font-size: 14px; font-weight: 300;">{{ usuario.nombre }} {{ usuario.apellido }} -
                        {{usuario.telefono }}</h6>
                </div>
                <div class="text-end ms-auto">
                    <div class="dropdown">
                        <button class="btn dropdown-toggle boton-dropdown border-0" type="button"
                            id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false"
                            style="color: #207198;">
                            <i class="fas fa-ellipsis-v fa-lg"></i>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton">
                            <li><button class="dropdown-item" data-bs-toggle="modal"
                                    data-bs-target="#agregarDomicilioModal">Editar</button></li>
                            <form method="POST" action="{% url 'eliminar_domicilio' usuario.direccion.id_direccion %}">
                                {% csrf_token %}
                                <li><button class="dropdown-item" type="submit">Eliminar</button></li>
                            </form>
                            
                        </ul>
                    </div>
                </div>
            </div>
            <hr class="mt-4">
            <div class="col-sm-12 col-md-12 col-lg-12 text-center ms-auto">
                <button class="btn border-0" type="button" style="color: #207198;" data-bs-toggle="modal"
                    data-bs-target="#agregarDomicilioModal">
                    <div class="d-flex">
                        <h5>Editar domicilio</h5>
                    </div>
                </button>
            </div>
            {% else %}
            <div class="col-sm-12 col-md-12 col-lg-12 mb-2 d-flex align-items-center">
                <div class="mx-auto my-3">
                    <h4>Aún no posees una direccion en tu cuenta</h4>
                </div>
            </div>
            <hr>
            <div class="col-sm-12 col-md-12 col-lg-12 text-center ms-auto">
                <button class="btn border-0" type="button" style="color: #207198;" data-bs-toggle="modal"
                    data-bs-target="#agregarDomicilioModal">
                    <div class="mt-2 d-flex">
                        <h5>Agregar domicilio</h5>
                    </div>
                </button>
            </div>
            {% endif %}
        </div>
    </div>
    <!-- End Card -->

    <!-- Modals -->

    <!-- Modal Agregar Tarjeta -->
    <div class="modal fade" id="agregarTarjetaModal" tabindex="-1" aria-labelledby="agregarTarjetaModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <form method="POST" action="{% url 'agregar_metodo_pago' %}">
                    {% csrf_token %}
                    <div class="modal-header border-bottom-0">
                        <h4 class="modal-title ms-3 mt-3" style="font-weight: 600;" id="agregarTarjetaModalLabel">
                            Agregar
                            nueva Tarjeta</h4>
                        <button type="button" class="btn-close me-3" style="box-shadow: none;" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row d-flex">
                            <div class="col-md-12 col-lg-6">
                                <div class="preload">
                                    <div class="creditcard mx-auto mt-4">
                                        <div class="front">
                                            <div id="ccsingle"></div>
                                            <svg version="1.1" id="cardfront" xmlns="http://www.w3.org/2000/svg"
                                                xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                                viewBox="0 0 750 471" style="enable-background:new 0 0 750 471;"
                                                xml:space="preserve">
                                                <g id="Front">
                                                    <g id="CardBackground">
                                                        <g id="Page-1_1_">
                                                            <g id="amex_1_">
                                                                <path id="Rectangle-1_1_" class="lightcolor grey" d="M40,0h670c22.1,0,40,17.9,40,40v391c0,22.1-17.9,40-40,40H40c-22.1,0-40-17.9-40-40V40
                                                    C0,17.9,17.9,0,40,0z" />
                                                            </g>
                                                        </g>
                                                        <path class="darkcolor greydark"
                                                            d="M750,431V193.2c-217.6-57.5-556.4-13.5-750,24.9V431c0,22.1,17.9,40,40,40h670C732.1,471,750,453.1,750,431z" />
                                                    </g>
                                                    <text transform="matrix(1 0 0 1 60.106 295.0121)" id="svgnumber"
                                                        class="st2 st3 st4">0123 4567
                                                        8910 1112</text>
                                                    <text transform="matrix(1 0 0 1 54.1064 428.1723)" id="svgname"
                                                        class="st2 st5 st6">NOMBRE
                                                        APELLIDO</text>
                                                    <text transform="matrix(1 0 0 1 54.1074 389.8793)"
                                                        class="st7 st5 st8">nombre titular</text>
                                                    <text transform="matrix(1 0 0 1 479.7754 388.8793)"
                                                        class="st7 st5 st8">fecha expiración</text>
                                                    <text transform="matrix(1 0 0 1 65.1054 241.5)"
                                                        class="st7 st5 st8">numero
                                                        tarjeta</text>
                                                    <g>
                                                        <text transform="matrix(1 0 0 1 574.4219 433.8095)"
                                                            id="svgexpire" class="st2 st5 st9">01/23</text>
                                                        <text transform="matrix(1 0 0 1 479.3848 417.0097)"
                                                            class="st2 st10 st11">VALID</text>
                                                        <text transform="matrix(1 0 0 1 479.3848 435.6762)"
                                                            class="st2 st10 st11">THRU</text>
                                                        <polygon class="st2"
                                                            points="554.5,421 540.4,414.2 540.4,427.9 		" />
                                                    </g>
                                                    <g id="cchip">
                                                        <g>
                                                            <path class="st2"
                                                                d="M168.1,143.6H82.9c-10.2,0-18.5-8.3-18.5-18.5V74.9c0-10.2,8.3-18.5,18.5-18.5h85.3
                                                c10.2,0,18.5,8.3,18.5,18.5v50.2C186.6,135.3,178.3,143.6,168.1,143.6z" />
                                                        </g>
                                                        <g>
                                                            <g>
                                                                <rect x="82" y="70" class="st12" width="1.5"
                                                                    height="60" />
                                                            </g>
                                                            <g>
                                                                <rect x="167.4" y="70" class="st12" width="1.5"
                                                                    height="60" />
                                                            </g>
                                                            <g>
                                                                <path class="st12" d="M125.5,130.8c-10.2,0-18.5-8.3-18.5-18.5c0-4.6,1.7-8.9,4.7-12.3c-3-3.4-4.7-7.7-4.7-12.3
                                                    c0-10.2,8.3-18.5,18.5-18.5s18.5,8.3,18.5,18.5c0,4.6-1.7,8.9-4.7,12.3c3,3.4,4.7,7.7,4.7,12.3
                                                    C143.9,122.5,135.7,130.8,125.5,130.8z M125.5,70.8c-9.3,0-16.9,7.6-16.9,16.9c0,4.4,1.7,8.6,4.8,11.8l0.5,0.5l-0.5,0.5
                                                    c-3.1,3.2-4.8,7.4-4.8,11.8c0,9.3,7.6,16.9,16.9,16.9s16.9-7.6,16.9-16.9c0-4.4-1.7-8.6-4.8-11.8l-0.5-0.5l0.5-0.5
                                                    c3.1-3.2,4.8-7.4,4.8-11.8C142.4,78.4,134.8,70.8,125.5,70.8z" />
                                                            </g>
                                                            <g>
                                                                <rect x="82.8" y="82.1" class="st12" width="25.8"
                                                                    height="1.5" />
                                                            </g>
                                                            <g>
                                                                <rect x="82.8" y="117.9" class="st12" width="26.1"
                                                                    height="1.5" />
                                                            </g>
                                                            <g>
                                                                <rect x="142.4" y="82.1" class="st12" width="25.8"
                                                                    height="1.5" />
                                                            </g>
                                                            <g>
                                                                <rect x="142" y="117.9" class="st12" width="26.2"
                                                                    height="1.5" />
                                                            </g>
                                                        </g>
                                                    </g>
                                                </g>
                                                <g id="Back">
                                                </g>
                                            </svg>
                                        </div>
                                        <div class="back">
                                            <svg version="1.1" id="cardback" xmlns="http://www.w3.org/2000/svg"
                                                xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                                viewBox="0 0 750 471" style="enable-background:new 0 0 750 471;"
                                                xml:space="preserve">
                                                <g id="Front">
                                                    <line class="st0" x1="35.3" y1="10.4" x2="36.7" y2="11" />
                                                </g>
                                                <g id="Back">
                                                    <g id="Page-1_2_">
                                                        <g id="amex_2_">
                                                            <path id="Rectangle-1_2_" class="darkcolor greydark" d="M40,0h670c22.1,0,40,17.9,40,40v391c0,22.1-17.9,40-40,40H40c-22.1,0-40-17.9-40-40V40
                                                C0,17.9,17.9,0,40,0z" />
                                                        </g>
                                                    </g>
                                                    <rect y="61.6" class="st2" width="750" height="78" />
                                                    <g>
                                                        <path class="st3" d="M701.1,249.1H48.9c-3.3,0-6-2.7-6-6v-52.5c0-3.3,2.7-6,6-6h652.1c3.3,0,6,2.7,6,6v52.5
                                            C707.1,246.4,704.4,249.1,701.1,249.1z" />
                                                        <rect x="42.9" y="198.6" class="st4" width="664.1"
                                                            height="10.5" />
                                                        <rect x="42.9" y="224.5" class="st4" width="664.1"
                                                            height="10.5" />
                                                        <path class="st5"
                                                            d="M701.1,184.6H618h-8h-10v64.5h10h8h83.1c3.3,0,6-2.7,6-6v-52.5C707.1,187.3,704.4,184.6,701.1,184.6z" />
                                                    </g>
                                                    <text transform="matrix(1 0 0 1 621.999 227.2734)" id="svgsecurity"
                                                        class="st6 st7">123</text>
                                                    <g class="st8">
                                                        <text transform="matrix(1 0 0 1 518.083 280.0879)"
                                                            class="st9 st6 st10">codigo seguridad</text>
                                                    </g>
                                                    <rect x="58.1" y="378.6" class="st11" width="375.5" height="13.5" />
                                                    <rect x="58.1" y="405.6" class="st11" width="421.7" height="13.5" />
                                                    <text transform="matrix(1 0 0 1 59.5073 228.6099)" id="svgnameback"
                                                        class="st12 st13">Nombre Apellido</text>
                                                </g>
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12 col-lg-6 datos-tarjeta">
                                <div class="form-container pe-0">
                                    <div class="field-container">
                                        <label for="namecard">Nombre Tarjeta</label>
                                        <input id="namecard" placeholder="Nombre Tarjeta" required minlength="3" maxlength="20"
                                            type="text" name="nombre_tarjeta">
                                    </div>
                                    <div class="field-container">
                                        <label for="name">Nombre Titular</label>
                                        <input id="name" placeholder="Nombre Apellido" minlength="3" required maxlength="20"
                                            type="text" name="nombre_titular">
                                    </div>
                                    <div class="field-container">
                                        <label for="cardnumber">Numero Tarjeta</label><span id="generatecard"></span>
                                        <input id="cardnumber" required pattern=".{19}" placeholder="0123 4567 8910 1112" type="text"
                                            inputmode="numeric" name="numero_tarjeta" title="La tarjeta debe tener 16 dígitos">
                                        <svg id="ccicon" class="ccicon" width="750" height="471" viewBox="0 0 750 471"
                                            version="1.1" xmlns="http://www.w3.org/2000/svg"
                                            xmlns:xlink="http://www.w3.org/1999/xlink">
                                        </svg>
                                    </div>
                                    <div class="field-container">
                                        <label for="expirationdate">Expiración (MM/YY)</label>
                                        <input id="expirationdate" required pattern=".{5}" placeholder="01/23" type="text"
                                            inputmode="numeric" name="fecha_vencimiento" title="El formato debe ser MM/YY">
                                    </div>
                                    <div class="field-container">
                                        <label for="securitycode">CVV</label>
                                        <input id="securitycode" required pattern="\d{3,4}" placeholder="123" type="text"
                                            inputmode="numeric" name="cvv" title="Ingrese un CVV válido de 3 o 4 dígitos">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer border-0">
                        <button type="submit" class="btn btn-lg ms-3"
                            style="color: white; background-color: #82C2CB; border-radius: 0;">Agregar Tarjeta</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- End Modal Agregar Tarjeta -->

    <!-- Modal Agregar Domicilio -->
    <div class="modal fade" id="agregarDomicilioModal" tabindex="-1" aria-labelledby="agregarDomicilioModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-bottom-0">
                    {% if direcciones != None %}
                    <h4 class="modal-title ms-3 mt-3" style="font-weight: 600;" id="agregarDomicilioModalLabel">Editar
                        Domicilio</h4>
                    {% else %}
                    <h4 class="modal-title ms-3 mt-3" style="font-weight: 600;" id="agregarDomicilioModalLabel">Agregar
                        nuevo Domicilio</h4>
                    {% endif %}
                    <button type="button" class="btn-close me-3" style="box-shadow: none;" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <form method="POST" action="{% url 'agregar_domicilio' %}">
                    {% csrf_token %}
                    <div class="modal-body">
                        <div class="row d-flex align-items-center">
                            <div class="col-md-12 col-lg-6">
                                <div>
                                    <img src="{% static 'img/domicilioDirection.png' %}" alt="" class="img-fluid"
                                        style="padding: 60px;">
                                </div>
                            </div>
                            <div class="col-md-12 col-lg-6">
                                <div>
                                    <p style="font-weight: 600;">Region</p>
                                    {% if direcciones != None %}
                                    <div class="input-group mb-3">
                                        <select class="form-select" required id="regionSelect">
                                            {% for region in regiones %}
                                            <option value="{{ region.id_region }}" {% if region.nombre == usuario.direccion.comuna.region.nombre%} selected {% endif %}>{{ region.nombre }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <p style="font-weight: 600;">Comuna</p>
                                    <div class="input-group mb-3">
                                        <select class="form-select" required id="comunaSelect" name="idcomuna">
                                            <option value="{{ usuario.direccion.comuna.id_comuna }}" selected>{{ usuario.direccion.comuna.nombre_comuna }}</option>
                                        </select>
                                    </div>
                                    <p style="font-weight: 600;">Direccion</p>
                                    <div class="input-group mb-3">
                                        <input type="text" class="form-control" name="direccion" required minlength="3" maxlength="80"
                                            aria-label="Sizing example input" placeholder="{{ usuario.direccion }}"
                                            aria-describedby="inputGroup-sizing-default">
                                    </div>
                                    {% else %}
                                    <div class="input-group mb-3">
                                        <select class="form-select" required id="regionSelect" name="region">
                                            <option value="" selected disabled>Seleccionar Región</option>
                                            {% for region in regiones %}
                                                <option value="{{ region.id_region }}">{{ region.nombre }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <p style="font-weight: 600;">Comuna</p>
                                    <div class="input-group mb-3">
                                        <select class="form-select" required id="comunaSelect" name="idcomuna">
                                            <option value="" selected disabled>Seleccionar Comuna</option>
                                            <!-- Opciones de comuna -->
                                        </select>
                                    </div>
                                    <p style="font-weight: 600;">Direccion</p>
                                    <div class="input-group mb-3">
                                        <input type="text" class="form-control" name="direccion" required minlength="3" maxlength="80"
                                            aria-label="Sizing example input"
                                            aria-describedby="inputGroup-sizing-default">
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer border-0">
                        <button type="submit" class="btn btn-lg ms-3"
                            style="color: white; background-color: #82C2CB; border-radius: 0;">Agregar
                            Domicilio</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- End Modal Agregar Domicilio -->

    <!-- End Modals -->
</div>

</div>

<script src='https://cdnjs.cloudflare.com/ajax/libs/imask/3.4.0/imask.min.js'></script>
<script src="{% static 'js/credit-card.js' %}"></script>



{% endblock %}


{% block script_final %}
<script src="{% static 'js/direccion.js' %}"></script>
{% endblock script_final %}