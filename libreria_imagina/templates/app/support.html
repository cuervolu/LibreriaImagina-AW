{% extends 'base.html' %}

{% load static %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/support.css' %}" />
{% endblock %}
{% load humanize %}
{% block title %}Soporte{% endblock title %}

{% block content %}
<div class="container my-5 py-3" style="max-width: 963px;">
    <div class="row justify-content-start mb-4">
        <div class="col-12 col-md-12 col-lg-12 ps-0">
            <p style="font-size: 36px; font-weight: 600;">¿En qué podemos ayudate?</p>
            <div class="d-flex">
                <div class="col-8 col-md-10 col-lg-10 mb-md-0 mt-2"
                    style="background-color: #FFFF; max-width: 100%; height: 60px; box-shadow: 0px 20px 88px rgba(0, 0, 0, 0.1); border-radius: 10px;">
                    <div class="input-group align-items-center">
                        <div class="input-group-prepend">
                            <span class="input-group-text bg-transparent border-0 mt-2" style="margin-right: -15px;"><i
                                    class="fa fa-search" style="color: gray;"></i></span>
                        </div>
                        <input class="form-control bg-transparent border-0 mt-2"
                            style="box-shadow: none; color: gray; font-weight: 500; font-size: 20px;" type="search"
                            value="" placeholder="Buscar en Soporte">
                    </div>
                </div>
                <div class="col-auto col-md-auto col-lg-auto mt-2 ms-auto">
                    <button disabled class="btn btn-gradient">Buscar</button>
                </div>
            </div>
        </div>
    </div>
    <div class="row justify-content-center">
        <!-- Card -->
        <p style="font-size: 26px; font-weight: 600;">Compras</p>
        <div class="card mb-5 d-flex"
            style="border-radius: 15px; filter: drop-shadow(0px 20px 88px rgba(0, 0, 0, 0.1)); border: none;">
            <div class="row">
                <div class="col-sm-12 col-md-12 col-lg-12 px-0">
                    <ul class="list-unstyled mb-0">
                        <li class="mb-0 border-bottom" style="border-bottom-width: 10px;">
                            <a {% if user.is_authenticated %} href="/my_purchases" {% else %} href="/auth/login" {% endif %} style="text-decoration: none;">
                                <div class="d-flex align-items-center mx-5 my-3 pt-2">
                                    <div class="me-4" style="width: 55px; height: 55px; color: black; font-size: 25px;">
                                        <img src="{% static 'img/purchases_bag.png' %}" alt="" class="img-fluid"
                                            style="width: 35px;">
                                    </div>
                                    <div>
                                        <h5 style="color: black;">Administrar y cancelar compras</h5>
                                        <h6 style="color: rgba(0, 0, 0, 0.582);">Pagar, seguir envios, modificar,
                                            reclamar o cancelar compras.</h6>
                                    </div>
                                    <div class="ms-auto" style="color: black;">
                                        <i class="fa-solid fa-chevron-right"></i>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li class="mb-0 border-bottom">
                            <a href="#" style="text-decoration: none;">
                                <div class="d-flex align-items-center mx-5 my-3">
                                    <div class="me-4" style="width: 55px; height: 55px; color: black; font-size: 25px;">
                                        <img src="{% static 'img/refunds.png' %}" alt="" class="img-fluid"
                                            style="width: 47px; left: 10px;">
                                    </div>
                                    <div>
                                        <h5 style="color: black;">Devoluciones y reembolsos</h5>
                                        <h6 style="color: rgba(0, 0, 0, 0.582);">Devolver un producto o consultar por
                                            reintegros de dinero de una compra.</h6>
                                    </div>
                                    <div class="ms-auto" style="color: black;">
                                        <i class="fa-solid fa-chevron-right"></i>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a data-bs-toggle="offcanvas" data-bs-target="#preguntasCompras" style="text-decoration: none;">
                                <div class="d-flex align-items-center mx-5 my-3">
                                    <div class="me-4" style="width: 55px; height: 55px; color: black; font-size: 25px;">
                                        <img src="{% static 'img/questions.png' %}" alt="" class="img-fluid"
                                            style="width: 35px;">
                                    </div>
                                    <div>
                                        <h5 style="color: black;">Preguntas frecuentes sobre compras</h5>
                                    </div>
                                    <div class="ms-auto" style="color: black;">
                                        <i class="fa-solid fa-chevron-right"></i>
                                    </div>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- End Card -->
        <!-- Card -->
        <p style="font-size: 26px; font-weight: 600;">Mantenimiento</p>
        <div class="card mb-5 d-flex"
            style="border-radius: 15px; filter: drop-shadow(0px 20px 88px rgba(0, 0, 0, 0.1)); border: none;">
            <div class="row">
                <div class="col-sm-12 col-md-12 col-lg-12 px-0">
                    <ul class="list-unstyled mb-0">
                        <li class="mb-0 border-bottom" style="border-bottom-width: 10px;">
                            {% if user.is_authenticated %}
                            <a data-bs-toggle="offcanvas" data-bs-target="#solicitarMantenimiento" style="text-decoration: none;">
                            {% else %} 
                            <a href="/auth/login" style="text-decoration: none;">
                            {% endif %}
                                <div class="d-flex align-items-center mx-5 my-3 pt-2">
                                    <div class="me-4"
                                        style="width: 55px; height: 55px; color: black; font-size: 25px;">
                                        <img src="{% static 'img/maintenance.png' %}" alt="" class="img-fluid"
                                            style="width: 35px;">
                                    </div>
                                    <div>
                                        <h5 style="color: black;">Solicitar Mantenimiento</h5>
                                        <h6 style="color: rgba(0, 0, 0, 0.582);">Mantenimiento físico, contenido o
                                            preventivo.</h6>
                                    </div>
                                    <div class="ms-auto" style="color: black;">
                                        <i class="fa-solid fa-chevron-right"></i>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li class="mb-0 border-bottom">
                            {% if user.is_authenticated %}
                            <a data-bs-toggle="offcanvas" data-bs-target="#misMantenimientos" style="text-decoration: none;">
                            {% else %} 
                            <a href="/auth/login" style="text-decoration: none;">
                            {% endif %}
                                <div class="d-flex align-items-center mx-5 my-3">
                                    <div class="me-4" style="width: 55px; height: 55px; color: black; font-size: 25px;">
                                        <img src="{% static 'img/follow-up_requests.png' %}" alt="" class="img-fluid"
                                            style="width: 35px;">
                                    </div>
                                    <div>
                                        <h5 style="color: black;">Seguimiento de solicitudes</h5>
                                        <h6 style="color: rgba(0, 0, 0, 0.582);">Ver progreso y estado de las
                                            solicitudes de mantenimiento.</h6>
                                    </div>
                                    <div class="ms-auto" style="color: black;">
                                        <i class="fa-solid fa-chevron-right"></i>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a data-bs-toggle="offcanvas" data-bs-target="#preguntasMantenimiento" style="text-decoration: none;">
                                <div class="d-flex align-items-center mx-5 my-3">
                                    <div class="me-4" style="width: 55px; height: 55px; color: black; font-size: 25px;">
                                        <img src="{% static 'img/questions.png' %}" alt="" class="img-fluid"
                                            style="width: 35px;">
                                    </div>
                                    <div>
                                        <h5 style="color: black;">Preguntas frecuentes sobre mantenimiento</h5>
                                    </div>
                                    <div class="ms-auto" style="color: black;">
                                        <i class="fa-solid fa-chevron-right"></i>
                                    </div>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- End Card -->
        <!-- Card -->
        <p style="font-size: 26px; font-weight: 600;">Sobre tu cuenta</p>
        <div class="card mb-5 d-flex"
            style="border-radius: 15px; filter: drop-shadow(0px 20px 88px rgba(0, 0, 0, 0.1)); border: none;">
            <div class="row">
                <div class="col-sm-12 col-md-12 col-lg-12 px-0">
                    <ul class="list-unstyled mb-0">
                        <li class="mb-0 border-bottom">
                            <a {% if user.is_authenticated %} href="/my_data" {% else %} href="/auth/login" {% endif %} style="text-decoration: none;">
                                <div class="d-flex align-items-center mx-5 my-3">
                                    <div style="height: 55px; color: black; font-size: 25px;"></div>
                                    <div>
                                        <h5 style="color: black;">Configuración de mi cuenta</h5>
                                    </div>
                                    <div class="ms-auto" style="color: black;">
                                        <i class="fa-solid fa-chevron-right"></i>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a data-bs-toggle="offcanvas" data-bs-target="#seguridadCuenta" style="text-decoration: none;">
                                <div class="d-flex align-items-center mx-5 my-3">
                                    <div style="height: 55px; color: black; font-size: 25px;"></div>
                                    <div>
                                        <h5 style="color: black;">Seguridad</h5>
                                    </div>
                                    <div class="ms-auto" style="color: black;">
                                        <i class="fa-solid fa-chevron-right"></i>
                                    </div>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- End Card -->
        <!-- Card -->
        <p style="font-size: 26px; font-weight: 600;">¿Necesitas más ayuda?</p>
        <div class="card mb-5 d-flex"
            style="border-radius: 15px; filter: drop-shadow(0px 20px 88px rgba(0, 0, 0, 0.1)); border: none;">
            <div class="row">
                <div class="col-sm-12 col-md-12 col-lg-12 px-0">
                    <ul class="list-unstyled mb-0">
                        <li>
                            <a data-bs-toggle="offcanvas" data-bs-target="#contactanos" style="text-decoration: none;">
                                <div class="d-flex align-items-center mx-5 my-3">
                                    <div style="height: 55px; color: black; font-size: 25px;"></div>
                                    <div>
                                        <h5 style="color: black;">Contáctanos</h5>
                                    </div>
                                    <div class="ms-auto" style="color: black;">
                                        <i class="fa-solid fa-chevron-right"></i>
                                    </div>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- End Card -->
    </div>


    <!-- Offcanvas -->

    <!-- Offcanvas Lateral -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="solicitarMantenimiento"
        style="border-top-left-radius: 15px; border-bottom-left-radius: 15px;">
        <div class="offcanvas-header mt-3">
            <h4 class="offcanvas-title fw-bold">Solicitar Mantenimiento</h4>
            <button type="button" class="btn-close shadow-none" data-bs-dismiss="offcanvas"
                aria-label="Cerrar"></button>
        </div>
        <div class="offcanvas-body">
            <form method="POST" action="{% url 'generar_mantenimiento' %}">
                {% csrf_token %}
                <div class="mb-3">
                    <label for="correoSolicitante" class="form-label">Correo del Solicitante</label>
                    <input type="email" id="email" name="email" class="form-control shadow-none" id="correoSolicitante"
                        placeholder="Ingrese su correo electrónico" required>
                </div>
                <div class="mb-3">
                    <label for="tipoMantenimiento" class="form-label">Tipo de Mantenimiento</label>
                    <select class="form-select shadow-none" id="tipoMantenimiento" name="tipoMantenimiento" required>
                        <option value="">Seleccione un tipo de mantenimiento</option>
                        {% for tipo in tipos_mantenimiento %}
                        <option value="{{ tipo }}">Mantenimiento {{ tipo }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="mb-3">
                    <label for="misPedidos" class="form-label">Pedido</label>
                    <select class="form-select shadow-none" id="misPedidos" name="misPedidos" {% if not pedidos %} disabled {% endif %} required>
                        {% if pedidos %}
                        <option value="">Seleccione un pedido</option>
                        {% else %}
                        <option value="">No posees pedidos aún</option>
                        {% endif %}
                        {% for pedido in pedidos %}
                        <option value="{{ pedido.id_pedido }}">Pedido #{{ pedido }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="mb-3">
                    <label for="libro" class="form-label">Libro</label>
                    <select class="form-select shadow-none" id="libro" name="libro" required>
                        <option value="">Seleccione un libro</option>
                    </select>
                </div>
                <div id="imagenLibroContainer" style="display: none; text-align: center;">
                    <img id="imagenLibro" class="img-fluid" style="width: 80px;" src="" alt="Imagen del libro">
                </div>
                <div class="mb-3">
                    <label for="comentario" class="form-label">Comentario</label>
                    <textarea class="form-control shadow-none" id="comentario" name="comentario" rows="3"
                        placeholder="Ingrese un comentario" required></textarea>
                </div>
                <button type="submit" {% if not pedidos %} disabled {% endif %} class="btn btn-gradient btn-block w-100">Enviar solicitud</button>
                {% if not pedidos %}
                <p style="font-size: 13px; color: #e24646;">Necesitas un pedido para realizar una solicitud.</p>
                {% endif %} 
            </form>
        </div>
    </div>

    <!-- Offcanvas Lateral -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="misMantenimientos" style="border-top-left-radius: 15px; border-bottom-left-radius: 15px; width: 500px">
        <div class="offcanvas-header mt-3">
            <h4 class="offcanvas-title fw-bold">Mis Mantenimientos</h4>
            <button type="button" class="btn-close shadow-none" data-bs-dismiss="offcanvas"
                aria-label="Cerrar"></button>
        </div>
        <div class="offcanvas-body">
            {% for mantenimiento in mantenimientos %}
            <div class="card mb-3 border-0">
                <div class="row g-0">
                    <div class="col-md-4 d-flex align-items-center justify-content-center">
                        <img src="{{ mantenimiento.libro.thumbnail }}" class="img-fluid" width="90px" alt="Imagen Libro">
                    </div>
                    <div class="col-md-8">
                        <div class="card-body">
                            <div class="d-flex align-items-center justify-content-between">
                                <h5 class="card-text" {% if mantenimiento.estado_mantenimiento == 'En Proceso' %} style="color: #eec146"
                                {% elif mantenimiento.estado_mantenimiento == 'Completado' %} style="color: #6FCF97"
                                {% elif mantenimiento.estado_mantenimiento == 'Cancelado' %} style="color: #e24646"
                                {% endif %}>{{ mantenimiento.estado_mantenimiento }}</h5>
                                <h6 class="card-text">N° solicitud: #{{ mantenimiento.id_mantenimiento }}</h6>
                            </div>
                            <p class="card-text" style="font-size: 14px;">Fecha de solicitud: {{ mantenimiento.fecha_solicitud|date:"d/m/y" }}</p></p>
                            <p class="card-text" style="font-size: 14px;">Tipo Mantenimiento: {{ mantenimiento.tipo_mantenimiento }}</p>
                            {% if mantenimiento.respuesta %}
                            <a href="#" class="card-text" style="font-size: 14px;">Ver respuesta</a>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="mt-3">
                    <a href="{% url 'maintenance' mantenimiento.id_mantenimiento %}" class="btn btn-gradient btn-block w-100 h-50">Ver solicitud</a>
                </div>
            </div>
            <hr>
            {% empty %}
            <div class="d-flex flex-column align-items-center justify-content-center">
                <h4 class="text-center">No posees solicitudes de mantenimientos.</h4>
                <img class="img-fluid" src="{% static 'img/nothingHere.png' %}" alt="">
            </div>
            {% endfor %}

        </div>
    </div>

    <!-- Offcanvas Lateral -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="preguntasCompras" style="border-top-right-radius: 15px; border-bottom-right-radius: 15px;">
        <div class="offcanvas-header mt-3">
            <h4 class="offcanvas-title fw-bold">Preguntas Frecuentes sobre compras</h4>
            <button type="button" class="btn-close shadow-none" data-bs-dismiss="offcanvas" aria-label="Cerrar"></button>
        </div>
        <div class="offcanvas-body">
            <h5>¿Cuánto tiempo tardan en llegar los pedidos de libros?</h5>
            <p>Los pedidos de libros suelen llegar aproximadamente en 3 días hábiles.</p>
            
            <h5>¿Cuál es el costo de envío para los libros?</h5>
            <p>El costo de envío para los libros es de 3200 pesos chilenos.</p>
            
            <h5>¿Puedo hacer seguimiento de mi pedido de libros?</h5>
            <p>Sí, una vez que tu pedido de libros sea despachado, recibirás un número de seguimiento para que puedas rastrear tu paquete.</p>
            
            <h5>¿Qué métodos de pago aceptan?</h5>
            <p>Aceptamos diversas formas de pago, como tarjetas de crédito, débito y transferencias bancarias.</p>
            
            <h5>¿Ofrecen devoluciones o cambios?</h5>
            <p>Sí, si por alguna razón deseas devolver o cambiar un libro, contáctanos dentro de los 7 días hábiles siguientes a la entrega para que podamos brindarte asistencia.</p>
        </div>
    </div>
    
    <!-- Offcanvas Lateral -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="preguntasMantenimiento" style="border-top-right-radius: 15px; border-bottom-right-radius: 15px;">
        <div class="offcanvas-header mt-3">
            <h4 class="offcanvas-title fw-bold">Preguntas Frecuentes sobre mantenimiento de libros</h4>
            <button type="button" class="btn-close shadow-none" data-bs-dismiss="offcanvas" aria-label="Cerrar"></button>
        </div>
        <div class="offcanvas-body">
            <h5>¿Cuántos tipos de mantenimiento ofrecen para los libros?</h5>
            <p>Ofrecemos tres tipos de mantenimiento para los libros: físico, contenido y preventivo.</p>
            
            <h5>¿En qué consiste el mantenimiento físico de un libro?</h5>
            <p>El mantenimiento físico de un libro implica acciones como limpieza, reparación de páginas o cubiertas dañadas, encuadernación, entre otros cuidados físicos para preservar la calidad del libro.</p>
            
            <h5>¿En qué consiste el mantenimiento de contenido de un libro?</h5>
            <p>El mantenimiento de contenido de un libro incluye la actualización de información, corrección de errores o erratas, adición de material complementario, como anexos o apéndices, y cualquier mejora relacionada con el contenido del libro.</p>
            
            <h5>¿En qué consiste el mantenimiento preventivo de un libro?</h5>
            <p>El mantenimiento preventivo de un libro se realiza para evitar daños o deterioro a largo plazo. Incluye recomendaciones de almacenamiento, manejo adecuado, consejos de cuidado y prevención de problemas comunes.</p>
        </div>
    </div>

    <!-- Offcanvas Lateral -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="seguridadCuenta" style="border-top-right-radius: 15px; border-bottom-right-radius: 15px;">
        <div class="offcanvas-header mt-3">
            <h4 class="offcanvas-title fw-bold">Seguridad de tu cuenta</h4>
            <button type="button" class="btn-close shadow-none" data-bs-dismiss="offcanvas" aria-label="Cerrar"></button>
        </div>
        <div class="offcanvas-body">
            <h5>¿Cómo puedo proteger mi cuenta?</h5>
            <p>Para proteger tu cuenta, te recomendamos seguir estas buenas prácticas:</p>
            <ul>
                <li>Utiliza contraseñas seguras, que contengan una combinación de letras, números y caracteres especiales.</li>
                <li>No compartas tu contraseña con nadie y evita usarla en otros sitios o servicios.</li>
                <li>Mantén tu software y aplicaciones actualizados para protegerte de posibles vulnerabilidades.</li>
                <li>Evita hacer clic en enlaces sospechosos o proporcionar información confidencial en sitios no confiables.</li>
            </ul>
            
            <h5>¿Qué medidas toman para proteger mi información personal?</h5>
            <p>Tomamos la protección de tu información personal muy en serio. Aquí están algunas de las medidas que implementamos:</p>
            <ul>
                <li>Utilizamos protocolos de seguridad, como el cifrado de datos, para proteger tu información durante su transmisión.</li>
                <li>Implementamos medidas de seguridad tecnológica y física para proteger nuestros sistemas contra accesos no autorizados.</li>
                <li>Realizamos auditorías y revisiones periódicas para garantizar el cumplimiento de las normas de seguridad y privacidad.</li>
                <li>Limitamos el acceso a tu información personal solo a los empleados autorizados que la necesitan para brindarte servicios.</li>
            </ul>
            
            <h5>¿Qué debo hacer si sospecho que mi cuenta ha sido comprometida?</h5>
            <p>Si sospechas que tu cuenta ha sido comprometida, te recomendamos que tomes las siguientes medidas de inmediato:</p>
            <ol>
                <li>Cambia tu contraseña de inmediato.</li>
                <li>Verifica tus transacciones recientes y notifica a nuestro equipo de soporte sobre cualquier actividad sospechosa.</li>
                <li>Revisa la configuración de seguridad de tu cuenta y asegúrate de que no haya cambios no autorizados.</li>
                <li>Escanea tu dispositivo en busca de posibles virus o malware.</li>
            </ol>
        </div>
    </div>

    <!-- Offcanvas Lateral -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="contactanos" style="border-top-left-radius: 15px; border-bottom-left-radius: 15px;">
        <div class="offcanvas-header mt-3">
            <h4 class="offcanvas-title fw-bold">Contáctanos</h4>
            <button type="button" class="btn-close shadow-none" data-bs-dismiss="offcanvas" aria-label="Cerrar"></button>
        </div>
        <div class="offcanvas-body">
            <form>
                <div class="mb-3">
                    <label for="nombre" class="form-label">Nombre</label>
                    <input type="text" class="form-control shadow-none" id="nombre" placeholder="Ingrese su nombre" required>
                </div>
                <div class="mb-3">
                    <label for="correo" class="form-label">Correo electrónico</label>
                    <input type="email" class="form-control shadow-none" id="correo" placeholder="Ingrese su correo electrónico" required>
                </div>
                <div class="mb-3">
                    <label for="telefono" class="form-label">Teléfono</label>
                    <input type="tel" class="form-control shadow-none" id="telefono" placeholder="Ingrese su número de teléfono" required>
                </div>
                <div class="mb-3">
                    <label for="asunto" class="form-label">Asunto</label>
                    <input type="text" class="form-control shadow-none" id="asunto" placeholder="Ingrese el asunto del mensaje" required>
                </div>
                <div class="mb-3">
                    <label for="mensaje" class="form-label">Mensaje</label>
                    <textarea class="form-control shadow-none" id="mensaje" rows="3" placeholder="Ingrese su mensaje" required></textarea>
                </div>
                <button type="submit" class="btn btn-gradient btn-block w-100">Enviar mensaje</button>
            </form>
        </div>
    </div>

    
    
    

</div>


{% if messages_json %}
  <script>
    window.addEventListener('DOMContentLoaded', function() {
      var messages = JSON.parse('{{ messages_json|escapejs }}');
      
      if (messages.length > 0) {
        var message = messages[0];
        Swal.fire({
          toast: true,
          position: 'top-end',
          showConfirmButton: false,
          timer: 5000,
          icon: 'success',  // Puedes ajustar el icono según el tipo de mensaje (success, error, warning, etc.)
          title: message
        });
      }
    });
  </script>
{% endif %}

{% endblock %}
<script src='https://cdnjs.cloudflare.com/ajax/libs/imask/3.4.0/imask.min.js'></script>

{% block script_final %}
<script src="{% static 'js/libros_pedido.js' %}"></script>
{% endblock script_final %}